<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Listing - PeerMarket</title>
  <link rel="stylesheet" href="/assets/css/base.css">
  <style>
    .gallery{display:grid;grid-template-columns:1fr;gap:10px}
    .gallery-main{width:100%;height:380px;border:1px solid #eee;border-radius:10px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .gallery-main img{width:100%;height:100%;object-fit:contain;background:#fafafa}
    .thumbs{display:grid;grid-template-columns:repeat(auto-fill,minmax(86px,1fr));gap:8px}
    .thumbs img{width:100%;height:80px;object-fit:cover;border-radius:8px;border:2px solid transparent;cursor:pointer}
    .thumbs img.active{border-color:#111}
    .row{display:flex;gap:20px;align-items:flex-start;flex-wrap:wrap}
    .detail{flex:1 1 360px}
    .side{width:280px;flex:0 0 280px}
    .muted b{color:#333}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .actions button{cursor:pointer}
    .related{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
  </style>
  <script src="/assets/js/api.js"></script>
  <script src="/assets/js/auth.js"></script>
  <script src="/assets/js/ui.js"></script>
  <script src="/assets/js/listing.js"></script>
</head>
<body>
  <div id="hdr"></div>

  <div class="container" style="margin-top:16px">
    <a href="/index.html" class="muted">← Back to browse</a>
  </div>

  <div class="container page" style="margin-top:12px">
    <div class="row">
      <div class="detail">
        <div class="gallery">
          <div class="gallery-main" id="g-main"><div class="muted">No image</div></div>
          <div class="thumbs" id="g-thumbs"></div>
        </div>

        <h2 id="title" style="margin:14px 0 6px">Loading...</h2>
        <div class="muted" style="margin-bottom:8px">
          <span id="city"></span>
          <span> • </span>
          <span>Posted <span id="created"></span></span>
          <span id="status" style="margin-left:6px"></span>
        </div>
        <div style="font-size:1.4em;font-weight:800"><span id="price"></span> ₮</div>

        <div class="actions">
          <button class="primary" id="fav-btn">♡ Favorite</button>
          <button id="report-btn">Report</button>
        </div>

        <div class="card" style="margin-top:14px">
          <h3 style="margin-top:6px">Description</h3>
          <div id="desc" style="white-space:pre-wrap"></div>
        </div>
      </div>

      <aside class="side">
        <div id="ad-right"></div>

        <div class="card" style="margin-top:14px">
          <div class="muted">Listing ID: <b id="lid"></b></div>
          <div class="muted">Category: <b id="cat"></b></div>
          <div class="muted">Expires: <b id="expires"></b></div>
        </div>

        <div class="card" style="margin-top:14px">
          <h3 style="margin:6px 0">Contact</h3>
          <div class="muted">Seller: <b id="owner-name">—</b></div>
          <div class="muted">Email: <b id="owner-email">—</b></div>
          <div class="muted">Phone: <b id="owner-phone">—</b></div>
        </div>
      </aside>
    </div>
  </div>

  <div class="container" style="margin-top:18px">
    <h3 style="margin:6px 0">Related</h3>
    <div id="related" class="related"></div>
  </div>

  <div id="ftr"></div>

  <script>
    (async () => {
      await UI.bootHeader();
      UI.mountFooter();
      UI.renderBanner('right', document.getElementById('ad-right'));
      await LISTING.init();
    })();
  </script>

  <dialog id="dlg-report" style="border:1px solid #ddd;border-radius:10px;padding:0;max-width:520px;width:100%">
    <div style="padding:12px 14px;border-bottom:1px solid #eee;font-weight:700">Report listing</div>
    <form method="dialog">
      <div style="padding:14px">
        <label for="rep-reason">Reason (optional)</label>
        <textarea id="rep-reason" rows="5" maxlength="1000" style="width:100%"></textarea>
      </div>
      <div style="display:flex;gap:10px;justify-content:flex-end;padding:12px 14px;border-top:1px solid #eee">
        <button id="rep-cancel" type="button">Cancel</button>
        <button class="primary" id="rep-send" type="button">Send report</button>
      </div>
    </form>
  </dialog>
</body>
</html>